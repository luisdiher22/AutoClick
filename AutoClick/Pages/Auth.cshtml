@page
@model AuthModel
@{
    ViewData["Title"] = "Iniciar Sesión / Registrarse - AutoClick.cr";
}

@section Styles {
    <link rel="stylesheet" href="~/css/auth.css" />
}

@section Scripts {
    <script src="~/js/auth.js"></script>
    <script>
        // Add body class for auth pages
        document.body.classList.add('auth-body');
    </script>
}

<div class="auth-container">
    <!-- Main Content -->
    <div class="auth-main">
        <div class="auth-content">
            <!-- Left Section - Registration -->
            <div class="auth-section register-section">
                <div class="section-header">
                    <h1 class="section-title">Crear cuenta</h1>
                    <p class="section-subtitle">Únase a la comunidad AutoClick.cr</p>
                </div>
                
                <form method="post" asp-page-handler="Register" class="auth-form" id="registerForm">
                    <div class="user-type-selection">
                        <h2 class="selection-title">¿Cómo desea registrarse?</h2>
                        
                        <div class="type-options">
                            <div class="type-option">
                                <input type="radio" id="tipoIndividuo" name="TipoUsuario" value="Individuo" />
                                <label for="tipoIndividuo" class="type-card">
                                    <div class="type-icon individual-icon">
                                        <div class="user-icon"></div>
                                    </div>
                                    <div class="type-content">
                                        <h3 class="type-title">Persona Individual</h3>
                                        <p class="type-description">Ideal para usuarios que quieren comprar o vender su auto personal</p>
                                        <ul class="type-features">
                                            <li>Publicar su vehículo personal sin ningún costo</li>
                                            <li>Acceso completo a búsquedas</li>
                                            <li>Guardados ilimitados</li>
                                        </ul>
                                    </div>
                                </label>
                            </div>
                            
                            <div class="type-option">
                                <input type="radio" id="tipoAgencia" name="TipoUsuario" value="Agencia" />
                                <label for="tipoAgencia" class="type-card">
                                    <div class="type-icon agency-icon">
                                        <div class="building-icon"></div>
                                    </div>
                                    <div class="type-content">
                                        <h3 class="type-title">Agencia / Concesionario</h3>
                                        <p class="type-description">Para empresas dedicadas a la compra y venta de vehículos</p>
                                        <ul class="type-features">
                                            <li>Publicaciones ilimitadas</li>
                                            <li>Herramientas empresariales</li>
                                            <li>Analytics y reportes</li>
                                            <li>Soporte prioritario</li>
                                        </ul>
                                    </div>
                                </label>
                            </div>
                        </div>
                        
                        <div class="register-actions">
                            <button type="submit" class="btn-register" id="btnContinueRegister" disabled>
                                Continuar registro
                            </button>
                            <p class="terms-text">
                                Al registrarse, acepta nuestros 
                                <a href="/TerminosCondiciones" class="terms-link">Términos y condiciones</a> y 
                                <a href="/PoliticaPrivacidad" class="terms-link">Política de privacidad</a>
                            </p>
                        </div>
                    </div>
                </form>
            </div>
            
            <!-- Divider -->
            <div class="auth-divider">
                <div class="divider-line"></div>
                <span class="divider-text">o</span>
                <div class="divider-line"></div>
            </div>
            
            <!-- Right Section - Login -->
            <div class="auth-section login-section" id="login">
                <div class="section-header">
                    <h1 class="section-title">Iniciar sesión</h1>
                    <p class="section-subtitle">Ingrese a su cuenta existente</p>
                </div>
                
                <form method="post" asp-page-handler="Login" class="auth-form" id="loginForm" autocomplete="off">
                    @if (!string.IsNullOrEmpty(Model.ReturnUrl))
                    {
                        <input type="hidden" name="ReturnUrl" value="@Model.ReturnUrl" />
                    }
                    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
                    {
                        <div class="error-message" id="serverErrorMessage">
                            <i class="fas fa-exclamation-triangle" style="margin-right: 8px;"></i>
                            @Model.ErrorMessage
                        </div>
                    }
                    
                    @if (!string.IsNullOrEmpty(Model.SuccessMessage))
                    {
                        <div class="success-message" id="serverSuccessMessage">
                            <i class="fas fa-check-circle" style="margin-right: 8px;"></i>
                            @Model.SuccessMessage
                        </div>
                    }
                    
                    <div class="form-group">
                        <label for="loginEmail">Correo electrónico</label>
                        <input type="email" id="loginEmail" name="LoginEmail" asp-for="LoginEmail" required 
                               placeholder="ejemplo@correo.com" class="form-input" autocomplete="off" />
                    </div>
                    
                    <div class="form-group">
                        <label for="loginPassword">Contraseña</label>
                        <input type="password" id="loginPassword" name="LoginPassword" asp-for="LoginPassword" required 
                               placeholder="Su contraseña" class="form-input" autocomplete="off" />
                        <a href="#" class="forgot-password" id="forgotPasswordLink">¿Olvidó su contraseña?</a>
                    </div>
                    
                    <div class="login-actions">
                        <button type="submit" class="btn-login" autocomplete="off" 
                                aria-haspopup="false" aria-expanded="false">
                            Iniciar sesión
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Recuperación de Contraseña -->
<div id="forgotPasswordModal" class="forgot-password-modal" style="display: none;">
    <div class="modal-overlay" id="forgotModalOverlay"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">Recuperar contraseña</h2>
            <button type="button" class="modal-close" id="closeForgotModal">&times;</button>
        </div>
        <div class="modal-body">
            <p class="modal-description">
                Ingrese el correo electrónico asociado a su cuenta y le enviaremos instrucciones para recuperar su contraseña.
            </p>
            <form id="forgotPasswordForm">
                <div class="form-group">
                    <label for="forgotEmail">Correo electrónico</label>
                    <input type="email" 
                           id="forgotEmail" 
                           name="ForgotPasswordEmail" 
                           class="form-input" 
                           placeholder="ejemplo@correo.com" 
                           required />
                    <span class="field-error" id="forgotEmailError" style="display: none;"></span>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="cancelForgotPassword">Cancelar</button>
                    <button type="submit" class="btn-primary" id="submitForgotPassword">
                        <span class="btn-text">Enviar instrucciones</span>
                        <span class="btn-spinner" style="display: none;">⏳ Enviando...</span>
                    </button>
                </div>
                <div class="success-message" id="forgotSuccessMessage" style="display: none; margin-top: 16px;"></div>
                <div class="error-message" id="forgotErrorMessage" style="display: none; margin-top: 16px;"></div>
            </form>
        </div>
    </div>
</div>

<style>
.forgot-password-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 10000;
    animation: fadeIn 0.3s ease-out;
}

.modal-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.75);
    backdrop-filter: blur(4px);
}

.modal-content {
    position: relative;
    max-width: 500px;
    width: 90%;
    margin: 80px auto;
    background: #02081C;
    border: 2px solid rgba(215, 220, 215, 0.2);
    border-radius: 16px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    animation: slideDown 0.3s ease-out;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 24px 32px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.modal-title {
    color: #f2f2f4;
    font-size: 24px;
    font-weight: 700;
    margin: 0;
    font-family: Montserrat, sans-serif;
}

.modal-close {
    background: none;
    border: none;
    color: rgba(255, 255, 255, 0.6);
    font-size: 32px;
    cursor: pointer;
    padding: 0;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    line-height: 1;
}

.modal-close:hover {
    color: #FF931E;
    transform: rotate(90deg);
}

.modal-body {
    padding: 32px;
}

.modal-description {
    color: rgba(255, 255, 255, 0.8);
    font-size: 15px;
    line-height: 1.6;
    margin: 0 0 24px 0;
    font-family: Montserrat, sans-serif;
}

.modal-actions {
    display: flex;
    gap: 12px;
    margin-top: 24px;
}

.btn-primary,
.btn-secondary {
    flex: 1;
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    font-size: 15px;
    font-weight: 600;
    font-family: Montserrat, sans-serif;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.btn-primary {
    background: linear-gradient(135deg, #FF931E, #FF7A00);
    color: white;
}

.btn-primary:hover:not(:disabled) {
    background: linear-gradient(135deg, #FF7A00, #FF6600);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(255, 147, 30, 0.4);
}

.btn-primary:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.btn-secondary {
    background: rgba(255, 255, 255, 0.05);
    color: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.btn-secondary:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.3);
}

.field-error {
    color: #FF4444;
    font-size: 13px;
    margin-top: 8px;
}

@@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@@media (max-width: 600px) {
    .modal-content {
        width: 95%;
        margin: 40px auto;
    }
    
    .modal-header,
    .modal-body {
        padding: 20px;
    }
    
    .modal-actions {
        flex-direction: column;
    }
}
</style>

