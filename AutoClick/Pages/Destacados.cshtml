@page "/destacados"
@model DestacadosModel
@{
    ViewData["Title"] = "Autos Destacados - AutoClick.cr";
}

<!-- Header -->
<!-- Header removed - Using universal header -->
    <div class="logo-container">
        <a asp-page="/Index">
            <img src="~/images/logo.png" alt="AutoClick.cr" style="height: 23px;" />
        </a>
    </div>
    
    <nav class="nav-menu">
        <div>
            <img src="~/images/costa-rica-flag.png" alt="Costa Rica" style="width: 67px; height: 31px;" />
        </div>
        <div class="nav-dropdown-container">
            <a href="#" class="nav-item nav-dropdown">An√∫nciese</a>
            <div class="dropdown-menu">
                <a asp-page="/RegistroAgencia" class="dropdown-item">Registrarse como agencia</a>
                <a asp-page="/AnunciarEmpresa" class="dropdown-item">Anuncie su empresa</a>
            </div>
        </div>
        <div class="nav-dropdown-container">
            <a href="#" class="nav-item nav-dropdown">Productos & Servicios</a>
            <div class="dropdown-menu">
                <a asp-page="/PpfCeramico" class="dropdown-item">PPF y Cer√°mico</a>
                <a asp-page="/RaloyDetailing" class="dropdown-item">Raloy - Detailing</a>
            </div>
        </div>
        <div class="nav-dropdown-container">
            <a href="#" class="nav-item nav-dropdown">Financiamiento</a>
            <div class="dropdown-menu">
                <a asp-page="/Gumout" class="dropdown-item">Gumout</a>
            </div>
        </div>
    </nav>
    
    <div class="header-actions">
        <div style="border-radius: 4px; padding: 12px; border: 2px solid white;">
            <div style="width: 20px; height: 17px; border: 2px solid white;"></div>
        </div>
        <a href="#" class="login-btn">
            <div style="width: 5px; height: 5px; background: white; margin-right: 5px;"></div>
            <div style="width: 10px; height: 6px; background: white; margin-right: 8px;"></div>
            Nombre A.
        </a>
    </div>
</header>

<!-- Page Content -->
<div class="destacados-container">
    <!-- Breadcrumb Navigation -->
    <nav class="destacados-breadcrumb">
        <a asp-page="/Index" class="breadcrumb-link">Inicio</a>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-current">Autos Destacados</span>
    </nav>

    <!-- Page Header -->
    <div class="destacados-header">
        <div class="destacados-title-section">
            <h1 class="destacados-main-title">Autos Destacados</h1>
            <p class="destacados-subtitle">Descubre nuestra selecci√≥n premium de veh√≠culos destacados</p>
            <div class="destacados-count">
                <span class="count-number">@Model.TotalCars</span> autos destacados disponibles
            </div>
        </div>
        
        <!-- Sort Dropdown -->
        <div class="destacados-sort-section">
            <select class="destacados-sort-select" onchange="changeDestacadosSorting(this.value)">
                <option value="recent" selected="@(Model.SortBy == "recent")">Ordenar por: M√°s recientes</option>
                <option value="price-desc" selected="@(Model.SortBy == "price-desc")">Ordenar por: Precio mayor a menor</option>
                <option value="price-asc" selected="@(Model.SortBy == "price-asc")">Ordenar por: Precio menor a mayor</option>
                <option value="year" selected="@(Model.SortBy == "year")">Ordenar por: A√±o m√°s nuevo</option>
                <option value="brand" selected="@(Model.SortBy == "brand")">Ordenar por: Marca A-Z</option>
            </select>
        </div>
    </div>

    <!-- Featured Badge Section -->
    <div class="destacados-badge-section">
        <div class="premium-badge">
            <div class="premium-icon">‚≠ê</div>
            <div class="premium-text">
                <h3>Selecci√≥n Premium</h3>
                <p>Veh√≠culos cuidadosamente seleccionados por nuestros expertos</p>
            </div>
        </div>
    </div>

    <!-- Cars Grid - 3x4 Layout -->
    <div class="destacados-cars-grid">
        @foreach (var auto in Model.Autos)
        {
            <a asp-page="/Producto" asp-route-id="@auto.Id" style="text-decoration: none; color: inherit;">
                <div class="destacados-car-card">
                    <!-- Premium Overlay -->
                    <div class="premium-overlay">
                        <div class="premium-star">‚òÖ</div>
                    </div>
                    
                    <div class="destacados-car-image-container">
                        <img src="@auto.ImagenPrincipal" alt="@auto.NombreCompleto" class="destacados-car-image" />

                        @* Bander√≠n Tag - Soporte para Video (MP4) y GIF *@
                        @if (!string.IsNullOrEmpty(auto.BanderinVideoUrl))
                        {
                            <div style="position: absolute; top: 8px; right: 8px; width: 80px; height: 80px; pointer-events: none; z-index: 20;">
                                @if (auto.BanderinVideoUrl.EndsWith(".gif", StringComparison.OrdinalIgnoreCase))
                                {
                                    <img src="@auto.BanderinVideoUrl" style="width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.5));" alt="Bander√≠n" />
                                }
                                else
                                {
                                    <video autoplay loop muted playsinline preload="auto" style="width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.5));">
                                        <source src="@auto.BanderinVideoUrl" type="video/mp4">
                                    </video>
                                }
                            </div>
                        }

                        <!-- Featured Badge -->
                        <div class="featured-premium-badge">Destacado Premium</div>
                        
                        <!-- Favorite Button -->
                        <div class="destacados-car-favorite">
                            <button class="destacados-favorite-btn" title="Agregar a favoritos" onclick="event.stopPropagation(); event.preventDefault();">
                                <svg width="20" height="17" viewBox="0 0 24 24" fill="none">
                                    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="none" stroke="currentColor" stroke-width="2"/>
                                </svg>
                            </button>
                        </div>

                        <!-- Premium Features -->
                        <div class="premium-features">
                            <span class="feature-tag">Garant√≠a Premium</span>
                            <span class="feature-tag">Revisi√≥n Completa</span>
                        </div>
                    </div>
                    
                    <div class="destacados-car-info">
                        <h3 class="destacados-car-title">@auto.NombreCompleto</h3>
                        <div class="destacados-car-year-brand">@auto.Ano ‚Ä¢ @System.Globalization.CultureInfo.CurrentCulture.TextInfo.ToTitleCase((auto.Marca ?? "").ToLower())</div>
                        <p class="destacados-car-price">@auto.ValorFiscalFormateado</p>
                        
                        <!-- Premium Deal Badge -->
                        <div class="premium-deal-badge">
                            <img src="https://placehold.co/22x11" alt="Icono oferta premium" />
                            <span>Oferta Premium</span>
                        </div>
                        
                        <!-- Car Features -->
                        <div class="car-features">
                            <div class="feature-item">
                                <span class="feature-icon">üõ°Ô∏è</span>
                                <span>Garant√≠a extendida</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">üîß</span>
                                <span>Mantenimiento incluido</span>
                            </div>
                        </div>
                        
                        <!-- Contact Buttons -->
                        <div class="contact-buttons">
                            <button class="premium-contact-btn" onclick="event.stopPropagation(); event.preventDefault();">Contactar Especialista</button>
                            <button class="schedule-visit-btn" onclick="event.stopPropagation(); event.preventDefault();">Agendar Visita</button>
                        </div>
                        
                        <!-- Additional Premium Info -->
                        <div class="car-additional-premium-info">
                            <div class="car-km">@((new Random().Next(1000, 25000)).ToString("N0")) km</div>
                            <div class="premium-financing">Financiamiento especial</div>
                        </div>
                    </div>
                </div>
            </a>
        }
    </div>

    <!-- Premium Services Section -->
    <div class="premium-services-section">
        <div class="service-card">
            <div class="service-icon">üèÜ</div>
            <h3>Certificaci√≥n Premium</h3>
            <p>Todos nuestros autos destacados pasan por una rigurosa inspecci√≥n de 150 puntos</p>
        </div>
        <div class="service-card">
            <div class="service-icon">üõ°Ô∏è</div>
            <h3>Garant√≠a Extendida</h3>
            <p>Protecci√≥n completa hasta por 3 a√±os en todos los veh√≠culos destacados</p>
        </div>
        <div class="service-card">
            <div class="service-icon">üíº</div>
            <h3>Asesor√≠a Especializada</h3>
            <p>Nuestros expertos te acompa√±an en todo el proceso de compra</p>
        </div>
    </div>

    <!-- Advertisement Banner -->
    <div class="destacados-ad-banner">
        <img src="https://placehold.co/143x23" alt="Logo publicitario" />
        <h2>SU ANUNCIO PREMIUM AQU√ç</h2>
        <p>Espacio publicitario exclusivo para marcas premium</p>
    </div>

    <!-- Pagination -->
    <nav class="destacados-pagination" aria-label="Paginaci√≥n de autos destacados">
        <div class="pagination-container">
            <!-- Previous Button -->
            <a href="@Url.Page("/Destacados", new { page = Model.CurrentPage - 1, sortBy = Model.SortBy })" 
               class="pagination-arrow @(Model.CurrentPage <= 1 ? "disabled" : "")">
                <svg width="17" height="14" viewBox="0 0 24 24" fill="none">
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" fill="currentColor"/>
                </svg>
            </a>

            <!-- Page Numbers -->
            @for (int i = Math.Max(1, Model.CurrentPage - 2); i <= Math.Min(Model.TotalPages, Model.CurrentPage + 2); i++)
            {
                <a href="@Url.Page("/Destacados", new { page = i, sortBy = Model.SortBy })" 
                   class="pagination-number @(Model.CurrentPage == i ? "active" : "")">
                    @i
                </a>
            }

            @if (Model.CurrentPage + 2 < Model.TotalPages)
            {
                <span class="pagination-ellipsis">‚Ä¶</span>
                
                <a href="@Url.Page("/Destacados", new { page = Model.TotalPages, sortBy = Model.SortBy })" 
                   class="pagination-number @(Model.CurrentPage == Model.TotalPages ? "active" : "")">
                    @Model.TotalPages
                </a>
            }

            <!-- Next Button -->
            <a href="@Url.Page("/Destacados", new { page = Model.CurrentPage + 1, sortBy = Model.SortBy })" 
               class="pagination-arrow @(Model.CurrentPage >= Model.TotalPages ? "disabled" : "")">
                <svg width="17" height="14" viewBox="0 0 24 24" fill="none">
                    <path d="M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z" fill="currentColor"/>
                </svg>
            </a>
        </div>
    </nav>
</div>

<!-- Footer -->
<partial name="_Footer" />

<script>
function changeDestacadosSorting(sortBy) {
    const url = new URL(window.location);
    url.searchParams.set('sortBy', sortBy);
    url.searchParams.set('page', '1');
    window.location.href = url.toString();
}
</script>