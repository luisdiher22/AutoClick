@page "/guardados"
@model GuardadosModel
@{
    ViewData["Title"] = "Autos Guardados - AutoClick.cr";
}

<!-- Header -->
<!-- Header removed - Using universal header -->
    <div class="logo-container">
        <a asp-page="/Index">
            <img src="~/images/logos/autoclick-logo-hd.png" alt="AutoClick.cr" style="height: 23px;" />
        </a>
    </div>
    
    <nav class="nav-menu">
        <div>
            <img src="~/images/costa-rica-flag.png" alt="Costa Rica" style="width: 67px; height: 31px;" />
        </div>
        <div class="nav-dropdown-container">
            <a href="#" class="nav-item nav-dropdown">Anúnciese</a>
            <div class="dropdown-menu">
                <a asp-page="/RegistroAgencia" class="dropdown-item">Registrarse como agencia</a>
                <a asp-page="/AnunciarEmpresa" class="dropdown-item">Anuncie su empresa</a>
            </div>
        </div>
        <div class="nav-dropdown-container">
            <a href="#" class="nav-item nav-dropdown">Productos & Servicios</a>
            <div class="dropdown-menu">
                <a asp-page="/PpfCeramico" class="dropdown-item">PPF y Cerámico</a>
                <a asp-page="/RaloyDetailing" class="dropdown-item">Raloy - Detailing</a>
            </div>
        </div>
        <div class="nav-dropdown-container">
            <a href="#" class="nav-item nav-dropdown">Financiamiento</a>
            <div class="dropdown-menu">
                <a asp-page="/Gumout" class="dropdown-item">Gumout</a>
            </div>
        </div>
    </nav>
    
    <div class="header-actions">
        <div style="border-radius: 4px; padding: 12px; border: 2px solid white;">
            <div style="width: 20px; height: 17px; border: 2px solid white;"></div>
        </div>
        <a href="#" class="login-btn">
            <div style="width: 5px; height: 5px; background: white; margin-right: 5px;"></div>
            <div style="width: 10px; height: 6px; background: white; margin-right: 8px;"></div>
            Nombre A.
        </a>
    </div>
</header>

<!-- Page Content -->
<div class="content-width">
    <!-- Breadcrumb Navigation -->
    <nav class="breadcrumb-nav-guardados">
        <a asp-page="/Index" class="breadcrumb-link">Inicio</a>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-current">Autos guardados</span>
    </nav>

    <!-- Page Header -->
    <div class="guardados-header">
        <h1 class="guardados-title">Autos guardados</h1>
        <div class="sort-dropdown">
            <select id="sortSelect" class="guardados-sort-select" onchange="changeSorting(this.value)">
                <option value="recent" selected="@(Model.SortBy == "recent")">Ordenar por: Más recientes</option>
                <option value="price-asc" selected="@(Model.SortBy == "price-asc")">Ordenar por: Precio menor a mayor</option>
                <option value="price-desc" selected="@(Model.SortBy == "price-desc")">Ordenar por: Precio mayor a menor</option>
                <option value="year" selected="@(Model.SortBy == "year")">Ordenar por: Año más nuevo</option>
            </select>
        </div>
    </div>

    <!-- Cars Grid - 3 Columns as shown in Figma -->
    <div class="guardados-grid">
        @foreach (var auto in Model.SavedAutos)
        {
            <a asp-page="/Producto" asp-route-id="@auto.Id" class="simple-auto-tile">
                <!-- Car Image -->
                <div class="simple-auto-tile-image">
                    <img src="@auto.ImagenPrincipal" alt="@auto.NombreCompleto" />

                </div>

                <!-- Car Info -->
                <div class="simple-auto-tile-info">
                    <div class="simple-auto-tile-title">@auto.NombreCompleto</div>
                    <div class="simple-auto-tile-price">@auto.PrecioEnCRC</div>
                </div>
            </a>
        }

        <!-- Advertisement Slot (as shown in Figma) -->
        @if (Model.SavedAutos.Count >= 7)
        {
            <div class="guardados-ad-slot">
                <img src="https://placehold.co/135x21" alt="Logo publicitario" class="ad-logo" />
                <h3 class="ad-title">SU ANUNCIO AQUÍ</h3>
                <p class="ad-subtitle">¡Haga click en este recuadro para empezar!</p>
            </div>
        }
    </div>

    <!-- Pagination -->
    <nav class="guardados-pagination" aria-label="Paginación de autos guardados">
        <div class="pagination-container">
            <!-- Previous Button -->
            <a href="@Url.Page("/Guardados", new { page = Model.CurrentPage - 1, sortBy = Model.SortBy })" 
               class="pagination-arrow @(Model.CurrentPage <= 1 ? "disabled" : "")">
                <svg width="17" height="14" viewBox="0 0 24 24" fill="none">
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" fill="currentColor"/>
                </svg>
            </a>

            <!-- Page Numbers -->
            @for (int i = 1; i <= Math.Min(5, Model.TotalPages); i++)
            {
                <a href="@Url.Page("/Guardados", new { page = i, sortBy = Model.SortBy })" 
                   class="pagination-number @(Model.CurrentPage == i ? "active" : "")">
                    @i
                </a>
            }

            @if (Model.TotalPages > 5)
            {
                @if (Model.TotalPages > 6)
                {
                    <span class="pagination-ellipsis">…</span>
                }
                
                <a href="@Url.Page("/Guardados", new { page = Model.TotalPages, sortBy = Model.SortBy })" 
                   class="pagination-number @(Model.CurrentPage == Model.TotalPages ? "active" : "")">
                    @Model.TotalPages
                </a>
            }

            <!-- Next Button -->
            <a href="@Url.Page("/Guardados", new { page = Model.CurrentPage + 1, sortBy = Model.SortBy })" 
               class="pagination-arrow @(Model.CurrentPage >= Model.TotalPages ? "disabled" : "")">
                <svg width="17" height="14" viewBox="0 0 24 24" fill="none">
                    <path d="M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z" fill="currentColor"/>
                </svg>
            </a>
        </div>
    </nav>

    <!-- Large Advertisement Banner -->
    <div class="guardados-large-ad">
        <img src="https://placehold.co/168x27" alt="Logo publicitario" class="large-ad-logo" />
        <h2 class="large-ad-title">SU ANUNCIO AQUÍ</h2>
        <p class="large-ad-subtitle">¡Haga click en este recuadro para empezar!</p>
    </div>
</div>

<!-- Footer -->
<partial name="_Footer" />

<script>
function changeSorting(sortBy) {
    const currentPage = @Model.CurrentPage;
    const url = `@Url.Page("/Guardados")?page=1&sortBy=${sortBy}`;
    window.location.href = url;
}
</script>



