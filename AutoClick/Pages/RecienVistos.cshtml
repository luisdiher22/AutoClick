@page "/recien-vistos"
@model RecienVistosModel
@{
    ViewData["Title"] = "Recién Vistos - AutoClick.cr";
}

<div style="width: 100%; min-height: 100vh; position: relative; background: #02081C; overflow: hidden">
    <!-- Breadcrumb Navigation -->
    <div style="left: 32px; top: 40px; position: absolute; justify-content: flex-start; align-items: center; gap: 8px; display: inline-flex">
        <div data-estado="Default" style="height: 40px; justify-content: center; align-items: center; gap: 8px; display: flex">
            <div style="justify-content: center; align-items: center; gap: 8px; display: flex">
                <a asp-page="/Index" style="text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 16px; font-family: Montserrat; font-weight: 400; word-wrap: break-word; text-decoration: none;">Inicio</a>
            </div>
        </div>
        <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 16px; font-family: Montserrat; font-weight: 400; word-wrap: break-word">/</div>
        <div data-estado="Default" style="height: 40px; justify-content: center; align-items: center; gap: 8px; display: flex">
            <div style="justify-content: center; align-items: center; gap: 8px; display: flex">
                <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 16px; font-family: Montserrat; font-weight: 400; word-wrap: break-word">Recién vistos</div>
            </div>
        </div>
    </div>

    <!-- Page Title -->
    <div style="left: 32px; top: 128px; position: absolute; text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 24px; font-family: Montserrat; font-weight: 700; word-wrap: break-word">Autos recién vistos</div>

    <!-- Sort Controls -->
    <div data-property-1="Frame 144" style="padding-left: 4px; padding-right: 4px; right: 32px; top: 105px; position: absolute; overflow: hidden; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: inline-flex">
        <div style="align-self: stretch; padding: 8px; border-radius: 4px; justify-content: flex-start; align-items: center; gap: 8px; display: inline-flex">
            <div data-estado="Default" style="height: 40px; justify-content: center; align-items: center; gap: 8px; display: flex">
                <div style="justify-content: center; align-items: center; gap: 8px; display: flex">
                    <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 16px; font-family: Montserrat; font-weight: 600; word-wrap: break-word">Ordenar por: Más recientes</div>
                </div>
            </div>
            <div style="width: 16px; height: 8px; background: white"></div>
        </div>
    </div>

    <!-- Cars Grid -->
    @{
        int totalCars = Model.RecentlyViewedAutos.Count();
        int columns = 3;
        int rows = (int)Math.Ceiling((double)totalCars / columns);
        int currentIndex = 0;
    }

    @if (totalCars > 0)
    {
        @foreach (var auto in Model.RecentlyViewedAutos)
        {
            int row = currentIndex / columns;
            int col = currentIndex % columns;
            int topPosition = 169 + (row * 312); // 312px spacing between rows
            int leftPosition = 22 + (col * 422); // 422px spacing between columns (412px width + 10px gap)

            <!-- Car Card -->
            <div data-estado="Default" style="width: 412px; height: 296px; padding-left: 10px; padding-right: 10px; padding-top: 8px; padding-bottom: 8px; left: @(leftPosition)px; top: @(topPosition)px; position: absolute; border-radius: 4px; flex-direction: column; justify-content: flex-start; align-items: flex-start; gap: 8px; display: inline-flex; cursor: pointer;" onclick="window.location.href='@Url.Page("/Producto", new { id = auto.Id })'">
                <div style="align-self: stretch; flex: 1 1 0; position: relative; overflow: hidden; border-radius: 4px; flex-direction: column; justify-content: flex-start; align-items: flex-start; gap: 8px; display: flex">
                    <img style="align-self: stretch; height: 209px; padding: 8px; border-radius: 4px; object-fit: cover;" src="@(string.IsNullOrEmpty(auto.ImagenPrincipal) ? "https://placehold.co/392x209" : auto.ImagenPrincipal)" alt="@auto.NombreCompleto" />

                    @* Banderín Tag Video *@
                    @if (!string.IsNullOrEmpty(auto.BanderinVideoUrl))
                    {
                        <div style="position: absolute; top: 16px; right: 16px; width: 80px; height: 80px; pointer-events: none; z-index: 10;">
                            <video autoplay loop muted playsinline preload="auto" style="width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.5));">
                                <source src="@auto.BanderinVideoUrl" type="video/mp4">
                            </video>
                        </div>
                    }

                    <div style="width: 355px; left: 0px; top: 225px; position: absolute; text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 20px; font-family: Montserrat; font-weight: 700; word-wrap: break-word">@auto.NombreCompleto</div>
                    <div style="left: 0px; top: 263px; position: absolute; text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 20px; font-family: Montserrat; font-weight: 500; word-wrap: break-word">@auto.ValorFiscalFormateado</div>

                    <!-- Share Icon -->
                    <div style="width: 16.67px; height: 20px; left: 375.33px; top: 260px; position: absolute; background: white"></div>

                    <!-- Favorite Icon -->
                    <div data-estado="Favoritos" style="left: 371px; top: 225px; position: absolute; flex-direction: column; justify-content: flex-start; align-items: flex-start; gap: 8px; display: flex">
                        <div style="width: 20px; height: 17px; background: white; outline: 2px white solid; outline-offset: -1px"></div>
                    </div>
                </div>
                
                @if (auto.PlanVisibilidad > 1)
                {
                    <!-- Premium Badge -->
                    <img style="width: 104px; height: 102.84px; left: 292px; top: -4px; position: absolute" src="https://placehold.co/104x103" />
                }
            </div>

            currentIndex++;
        }

        <!-- Advertisement Slots -->
        @if (totalCars >= 3)
        {
            <!-- First Advertisement (after 3rd car, in position where 4th car would be) -->
            <div data-property-1="Default" style="width: 393px; height: 281.27px; padding: 33.84px; left: 444.50px; top: 488px; position: absolute; background: rgba(255, 255, 255, 0.05); overflow: hidden; border-radius: 4.37px; flex-direction: column; justify-content: center; align-items: center; gap: 55.40px; display: inline-flex; cursor: pointer;" onclick="window.location.href='@Url.Page("/AnunciarEmpresa")'">
                <img style="width: 135.25px; height: 21.46px" src="https://placehold.co/135x21" />
                <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: white; font-size: 24px; font-family: Montserrat; font-weight: 700; word-wrap: break-word; text-shadow: 0px 2px 2px rgba(0, 0, 0, 0.50)">SU ANUNCIO AQUÍ</div>
                <div style="width: 269.51px; text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: white; font-size: 24px; font-family: Montserrat; font-weight: 500; word-wrap: break-word; text-shadow: 0px 2px 2px rgba(0, 0, 0, 0.50)">¡Haga click en este recuadro para empezar!</div>
            </div>
        }

        @if (totalCars >= 12)
        {
            <!-- Second Advertisement (after 12 cars) -->
            <div data-property-1="Default" style="width: 1010px; height: 196px; padding: 34.53px; left: 135px; top: @(169 + ((totalCars / 3 + 1) * 312))px; position: absolute; background: rgba(255, 255, 255, 0.05); overflow: hidden; border-radius: 4.46px; flex-direction: column; justify-content: center; align-items: center; gap: 24.53px; display: inline-flex; cursor: pointer;" onclick="window.location.href='@Url.Page("/AnunciarEmpresa")'">
                <img style="width: 168.35px; height: 26.72px" src="https://placehold.co/168x27" />
                <div style="align-self: stretch; text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: white; font-size: 34.53px; font-family: Montserrat; font-weight: 700; word-wrap: break-word; text-shadow: 0px 4px 4px rgba(0, 0, 0, 0.50)">SU ANUNCIO AQUÍ</div>
                <div style="align-self: stretch; text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: white; font-size: 23.02px; font-family: Montserrat; font-weight: 500; word-wrap: break-word; text-shadow: 0px 4px 4px rgba(0, 0, 0, 0.50)">¡Haga click en este recuadro para empezar!</div>
            </div>
        }

        <!-- Pagination -->
        <div style="width: 468px; height: 44px; left: 50%; top: @(169 + ((totalCars / 3 + 2) * 312))px; position: absolute; transform: translateX(-50%);">
            <div data-property-1="Default" style="width: 40px; left: 0px; top: 1px; position: absolute; border-radius: 40px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
                <div style="width: 40px; height: 40px; position: relative; transform: rotate(180deg); transform-origin: top left">
                    <div style="width: 38.05px; height: 38.05px; left: 0.98px; top: 0.98px; position: absolute; outline: 1px white solid; outline-offset: -0.50px"></div>
                    <div style="width: 16.69px; height: 14.37px; left: 11.04px; top: 12.82px; position: absolute; background: white"></div>
                </div>
            </div>
            <div style="width: 44px; height: 44px; padding: 2px; left: 50px; top: 0px; position: absolute; background: rgba(255, 255, 255, 0.25); border-radius: 44px; outline: 2px white solid; outline-offset: -2px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
                <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: white; font-size: 12px; font-family: Montserrat; font-weight: 600; word-wrap: break-word">1</div>
            </div>
            <div style="width: 44px; height: 44px; padding: 2px; left: 104px; top: 0px; position: absolute; border-radius: 44px; outline: 2px rgba(255, 255, 255, 0.75) solid; outline-offset: -2px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
                <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: white; font-size: 12px; font-family: Montserrat; font-weight: 600; word-wrap: break-word">2</div>
            </div>
            <div style="width: 44px; height: 44px; padding: 2px; left: 158px; top: 0px; position: absolute; border-radius: 44px; outline: 2px rgba(255, 255, 255, 0.75) solid; outline-offset: -2px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
                <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: white; font-size: 12px; font-family: Montserrat; font-weight: 600; word-wrap: break-word">3</div>
            </div>
            <div style="width: 44px; height: 44px; padding: 2px; left: 212px; top: 0px; position: absolute; border-radius: 44px; outline: 2px rgba(255, 255, 255, 0.75) solid; outline-offset: -2px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
                <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: white; font-size: 12px; font-family: Montserrat; font-weight: 600; word-wrap: break-word">4</div>
            </div>
            <div style="width: 44px; height: 44px; padding: 2px; left: 266px; top: 0px; position: absolute; border-radius: 44px; outline: 2px rgba(255, 255, 255, 0.75) solid; outline-offset: -2px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
                <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: white; font-size: 12px; font-family: Montserrat; font-weight: 600; word-wrap: break-word">5</div>
            </div>
            <div style="width: 44px; height: 44px; padding: 2px; left: 320px; top: 0px; position: absolute; border-radius: 44px; outline: 2px rgba(255, 255, 255, 0.75) solid; outline-offset: -2px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
                <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: white; font-size: 12px; font-family: Montserrat; font-weight: 600; word-wrap: break-word">…</div>
            </div>
            <div style="width: 44px; height: 44px; padding: 2px; left: 374px; top: 0px; position: absolute; border-radius: 44px; outline: 2px rgba(255, 255, 255, 0.75) solid; outline-offset: -2px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
                <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: white; font-size: 12px; font-family: Montserrat; font-weight: 600; word-wrap: break-word">@((totalCars / 9) + 1)</div>
            </div>
            <div data-property-1="Default" style="width: 40px; left: 468px; top: 41px; position: absolute; transform: rotate(180deg); transform-origin: top left; border-radius: 40px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
                <div style="width: 40px; height: 40px; position: relative; transform: rotate(180deg); transform-origin: top left">
                    <div style="width: 38.05px; height: 38.05px; left: 0.98px; top: 0.98px; position: absolute; outline: 1px white solid; outline-offset: -0.50px"></div>
                    <div style="width: 16.69px; height: 14.37px; left: 12.27px; top: 12.82px; position: absolute; background: white"></div>
                </div>
            </div>
        </div>
    }
    else
    {
        <!-- Empty State -->
        <div style="width: 100%; height: 400px; left: 0px; top: 300px; position: absolute; flex-direction: column; justify-content: center; align-items: center; gap: 32px; display: inline-flex">
            <div style="width: 80px; height: 80px; background: rgba(255, 255, 255, 0.1); border-radius: 50%; flex-direction: column; justify-content: center; align-items: center; display: flex">
                <div style="width: 40px; height: 40px; background: rgba(255, 255, 255, 0.3)"></div>
            </div>
            <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: white; font-size: 24px; font-family: Montserrat; font-weight: 700; word-wrap: break-word">No has visto ningún auto recientemente</div>
            <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: rgba(255, 255, 255, 0.7); font-size: 16px; font-family: Montserrat; font-weight: 400; word-wrap: break-word">Explora nuestro catálogo de autos y los verás aparecer aquí</div>
            <div data-estado="Default" style="padding: 16px; background: white; border-radius: 4px; justify-content: center; align-items: center; gap: 8px; display: inline-flex; cursor: pointer;" onclick="window.location.href='@Url.Page("/Index")'">
                <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; color: #06174D; font-size: 16px; font-family: Montserrat; font-weight: 700; word-wrap: break-word">Explorar autos</div>
            </div>
        </div>
    }

    <!-- Footer -->
    <div style="width: 100%; height: 304px; left: 0px; top: @(Math.Max(1745, 169 + ((Model.RecentlyViewedAutos.Count() / 3 + 4) * 312)))px; position: absolute; background: #030D2B; overflow: hidden; border-top: 0.50px rgba(255, 255, 255, 0.45) solid">
        <div style="left: 445.50px; top: 45px; position: absolute; justify-content: center; align-items: flex-start; gap: 62px; display: inline-flex">
            <div style="width: 193px; height: 173px; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: inline-flex">
                <div style="align-self: stretch; flex-direction: column; justify-content: flex-start; align-items: flex-start; gap: 40px; display: inline-flex">
                    <div style="align-self: stretch; text-box-trim: trim-both; text-box-edge: cap alphabetic; color: rgba(255, 255, 255, 0.50); font-size: 24px; font-family: Plus Jakarta Sans; font-weight: 700; word-wrap: break-word">AutoClick.cr</div>
                    <div style="flex-direction: column; justify-content: flex-start; align-items: flex-start; gap: 32px; display: flex">
                        <div data-estado="Default" style="justify-content: center; align-items: center; gap: 8px; display: inline-flex">
                            <div style="justify-content: center; align-items: center; gap: 8px; display: flex">
                                <a asp-page="/Contactanos" style="text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 16px; font-family: Montserrat; font-weight: 400; word-wrap: break-word; text-decoration: none;">Contáctenos</a>
                            </div>
                        </div>
                        <div data-estado="Default" style="justify-content: center; align-items: center; gap: 8px; display: inline-flex">
                            <div style="justify-content: center; align-items: center; gap: 8px; display: flex">
                                <a asp-page="/SobreNosotros" style="text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 16px; font-family: Montserrat; font-weight: 400; word-wrap: break-word; text-decoration: none;">Sobre Nosotros</a>
                            </div>
                        </div>
                        <div data-estado="Default" style="justify-content: center; align-items: center; gap: 8px; display: inline-flex">
                            <div style="justify-content: center; align-items: center; gap: 8px; display: flex">
                                <a asp-page="/ReportarProblema" style="text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 16px; font-family: Montserrat; font-weight: 400; word-wrap: break-word; text-decoration: none;">Reportar un problema</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div style="padding-top: 56px; flex-direction: column; justify-content: flex-start; align-items: flex-start; gap: 20px; display: inline-flex">
                <div data-estado="Default" style="justify-content: center; align-items: center; gap: 8px; display: inline-flex">
                    <div style="justify-content: center; align-items: center; gap: 8px; display: flex">
                        <a href="/TerminosCondiciones" style="text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 16px; font-family: Montserrat; font-weight: 400; word-wrap: break-word; text-decoration: none;">Términos y condiciones</a>
                    </div>
                </div>
                <div data-estado="Default" style="justify-content: center; align-items: center; gap: 8px; display: inline-flex">
                    <div style="justify-content: center; align-items: center; gap: 8px; display: flex">
                        <a href="/PoliticaPrivacidad" style="text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 16px; font-family: Montserrat; font-weight: 400; word-wrap: break-word; text-decoration: none;">Política de privacidad</a>
                    </div>
                </div>
            </div>
            <div style="width: 285px; flex-direction: column; justify-content: flex-start; align-items: flex-start; gap: 16px; display: inline-flex">
                <div style="align-self: stretch; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
                    <div style="align-self: stretch; text-box-trim: trim-both; text-box-edge: cap alphabetic; color: rgba(255, 255, 255, 0.50); font-size: 24px; font-family: Plus Jakarta Sans; font-weight: 700; word-wrap: break-word">Suscribete</div>
                    <div data-estado="Default" data-label2="false" style="width: 175px; height: 61px; position: relative">
                        <div style="width: 175px; height: 44px; padding-top: 8px; padding-bottom: 8px; padding-left: 16px; padding-right: 64px; left: 0px; top: 17px; position: absolute; background: #02081C; border-radius: 4px; outline: 0.50px rgba(255, 255, 255, 0.50) solid; outline-offset: -0.50px; justify-content: flex-start; align-items: center; gap: 8px; display: inline-flex">
                            <input type="email" placeholder="Introducir correo" style="border: none; outline: none; background: transparent; text-box-trim: trim-both; text-box-edge: cap alphabetic; color: rgba(255, 255, 255, 0.50); font-size: 14px; font-family: Montserrat; font-weight: 500; word-wrap: break-word; width: 100%;" />
                        </div>
                        <div style="width: 44px; height: 9px; left: 0px; top: 0px; position: absolute; justify-content: flex-start; align-items: center; gap: 4px; display: inline-flex"></div>
                    </div>
                </div>
                <div style="align-self: stretch; text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 14px; font-family: Montserrat; font-weight: 500; word-wrap: break-word">Suscríbase para recibir las últimas noticias y promociones</div>
                <div data-estado="Default" style="height: 44px; padding: 16px; background: #0A2680; border-radius: 4px; outline: 0.50px white solid; outline-offset: -0.50px; justify-content: center; align-items: center; gap: 8px; display: inline-flex; cursor: pointer;">
                    <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; color: white; font-size: 16px; font-family: Montserrat; font-weight: 700; word-wrap: break-word">Suscribirse</div>
                </div>
            </div>
        </div>
        
        <!-- Logo y redes sociales -->
        <div style="width: 289px; height: 143px; left: 40px; top: 40px; position: absolute; flex-direction: column; justify-content: center; align-items: flex-start; gap: 32px; display: inline-flex">
            <img style="align-self: stretch; height: 45.86px" src="https://placehold.co/289x46" alt="AutoClick.cr Logo" />
            <div style="align-self: stretch; justify-content: center; align-items: center; gap: 48px; display: inline-flex">
                <div data-color="Negative" data-platform="Facebook" style="width: 32px; height: 32px; position: relative; overflow: hidden">
                    <div style="width: 32px; height: 31.88px; left: 0px; top: 0px; position: absolute; background: white"></div>
                </div>
                <div data-color="Negative" data-platform="Instagram" style="width: 32px; height: 32px; position: relative; overflow: hidden">
                    <div style="width: 31.98px; height: 31.99px; left: 0px; top: 0px; position: absolute; background: white"></div>
                    <div style="width: 16.44px; height: 16.44px; left: 7.78px; top: 7.78px; position: absolute; background: white"></div>
                    <div style="width: 3.84px; height: 3.84px; left: 22.62px; top: 5.54px; position: absolute; background: white"></div>
                </div>
                <div data-color="Negative" data-platform="WhatsApp" style="width: 32px; height: 32px; position: relative">
                    <div style="width: 31.85px; height: 32px; left: 0px; top: 0px; position: absolute; background: white"></div>
                </div>
            </div>
        </div>
        
        <!-- Copyright -->
        <div style="left: 428px; top: 268px; position: absolute; justify-content: center; align-items: center; gap: 10px; display: inline-flex">
            <img style="width: 20px; height: 20px; transform: rotate(180deg); transform-origin: top left" src="https://placehold.co/20x20" />
            <div style="text-box-trim: trim-both; text-box-edge: cap alphabetic; text-align: center; color: white; font-size: 16px; font-family: Montserrat; font-weight: 300; word-wrap: break-word">2025. Todos los derechos reservados - AutoClick.cr</div>
        </div>
    </div>
</div>